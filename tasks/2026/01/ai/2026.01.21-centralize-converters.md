# Centralize Converters

**Date**: 2026-01-21  
**Status**: Cancelled  
**Priority**: High  
**Source**: [OCP Protocol Review](./2026.01.21-ocp-protocol-review.md) — Issue 2.1

## Status Update (2026-01-21)

**CANCELLED** - This task conflicts with the established SDK architecture documented in `llms.txt`.

The SDK uses a **per-entity folder pattern**, not centralized converters:

```
src/functions/OpenCapTable/{entityType}/
├── {entityType}DataToDaml.ts   # OCF→DAML converter
├── get{EntityType}AsOcf.ts     # DAML→OCF converter
└── index.ts
```

The correct approach is documented in:

- [Converter File Organization Pattern](./2026.01.21-converter-file-organization.md) - enforces
  per-entity folders
- `llms.txt` - establishes the architecture

### What SHOULD be centralized

Only **shared utilities** should be centralized:

- `src/utils/typeConversions.ts` - date, numeric, monetary conversions
- `src/utils/enumConversions.ts` - all enum mappings (already exists)
- `src/functions/OpenCapTable/capTable/ocfToDaml.ts` - dispatcher (imports from entity folders)

Entity-specific converters stay in their entity folders.

---

## Original Problem Statement (Preserved for Context)

DAML↔OCF conversion functions are scattered across multiple locations:

- `src/functions/OpenCapTable/*/create*.ts` — `*DataToDaml` functions
- `src/functions/OpenCapTable/*/get*AsOcf.ts` — `daml*ToNative` functions
- `src/functions/OpenCapTable/capTable/ocfToDaml.ts` — dispatcher
- `src/utils/typeConversions.ts` — shared helpers

The same enum conversion logic appears in multiple files.

## Evidence

```typescript
// In createIssuer.ts
function emailTypeToDaml(emailType: EmailType): Fairmint.OpenCapTable.Types.OcfEmailType {
  switch (emailType) { ... }
}

// In getIssuerAsOcf.ts
function damlEmailTypeToNative(damlType: Fairmint.OpenCapTable.Types.OcfEmailType): EmailType {
  switch (damlType) { ... }
}
```

## Original Recommendation (NOT RECOMMENDED)

~~Create a `src/converters/` directory with:~~

~~- `src/converters/enums.ts` — all enum conversions (bidirectional)~~ ~~- `src/converters/types.ts`
— shared type conversions~~ ~~- `src/converters/entities/<entity>.ts` — entity-specific
conversions~~ ~~- `src/converters/index.ts` — unified `toDaml()` and `toOcf()` dispatchers~~

## Correct Approach

For enum deduplication, centralize in `src/utils/enumConversions.ts` (already exists). For entity
converters, keep in per-entity folders per `llms.txt` architecture.
