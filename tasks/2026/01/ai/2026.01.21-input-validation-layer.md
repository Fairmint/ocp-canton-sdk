# Input Validation Layer

**Date**: 2026-01-21  
**Status**: Open  
**Priority**: Medium  
**Source**: [OCP Protocol Review](./2026.01.21-ocp-protocol-review.md) â€” Issue 3.3

## Problem

The batch API validates `id` field presence but not other required fields. Invalid data may pass to
DAML and fail at contract execution time with cryptic errors.

## Recommendation

Add comprehensive input validation in `convertToDaml()`:

```typescript
function validateStakeholderInput(data: OcfStakeholder): void {
  if (!data.id) throw new OcpValidationError('stakeholder.id', 'Required');
  if (!data.name?.legal_name)
    throw new OcpValidationError('stakeholder.name.legal_name', 'Required');
  if (!data.stakeholder_type)
    throw new OcpValidationError('stakeholder.stakeholder_type', 'Required');
}
```

## Tasks

- [ ] Document required fields for each OCF entity type
- [ ] Create validation functions for each entity type
- [ ] Integrate validation into `convertToDaml()` dispatcher
- [ ] Add clear error messages with field paths
- [ ] Add tests for validation edge cases

## Acceptance Criteria

- All required fields validated before DAML conversion
- Error messages include specific field paths
- Invalid data fails fast with clear errors (not at DAML level)
- Tests cover common validation scenarios
