# OCF Remaining Types (Low Priority)

**Date**: 2026-01-20 **Status**: Complete **Priority**: Low **Parent**:
[Milestone 2: OCP SDK Implementation](../../../2025/12/2025.12.17-milestone-2-ocp-sdk-implementation.md)

## Overview

Implement SDK support for remaining OCF types that are less commonly used in typical cap table
workflows. These should be implemented after higher-priority types are complete.

## Types to Implement (9 types)

### Retraction Types (4 types)

| Type                         | Description                             | DAML Support |
| ---------------------------- | --------------------------------------- | ------------ |
| ConvertibleRetraction        | Retract a convertible issuance          | ✅           |
| EquityCompensationRetraction | Retract an equity compensation issuance | ✅           |
| StockRetraction              | Retract a stock issuance                | ✅           |
| WarrantRetraction            | Retract a warrant issuance              | ✅           |

### Equity Compensation Events (2 types)

| Type                        | Description                        | DAML Support |
| --------------------------- | ---------------------------------- | ------------ |
| EquityCompensationRelease   | Release vested equity compensation | ✅           |
| EquityCompensationRepricing | Reprice options (underwater opts)  | ✅           |

### Stock Plan Events (1 type)

| Type                  | Description                      | DAML Support |
| --------------------- | -------------------------------- | ------------ |
| StockPlanReturnToPool | Return shares to stock plan pool | ✅           |

### Stakeholder Events (2 types)

| Type                               | Description                     | DAML Support |
| ---------------------------------- | ------------------------------- | ------------ |
| StakeholderRelationshipChangeEvent | Change stakeholder relationship | ✅           |
| StakeholderStatusChangeEvent       | Change stakeholder status       | ✅           |

## Implementation Checklist

### Retraction Types

- [x] Add `toConvertibleRetraction` converter (already existed in ocfToDaml.ts)
- [x] Add `toEquityCompensationRetraction` converter (already existed in ocfToDaml.ts)
- [x] Add `toStockRetraction` converter (already existed in ocfToDaml.ts)
- [x] Add `toWarrantRetraction` converter (already existed in ocfToDaml.ts)
- [x] Add unit tests for all retraction converters

### Equity Compensation Events

- [x] Add `toEquityCompensationRelease` converter (already existed in ocfToDaml.ts)
- [x] Add `toEquityCompensationRepricing` converter (already existed in ocfToDaml.ts)
- [x] Add unit tests for converters

### Stock Plan Events

- [x] Add `toStockPlanReturnToPool` converter (already existed in ocfToDaml.ts)
- [x] Add unit tests for converters

### Stakeholder Events

- [x] Add `OcfStakeholderRelationshipChangeEvent` native type to native.ts
- [x] Add `OcfStakeholderStatusChangeEvent` native type to native.ts
- [x] Add `toStakeholderRelationshipChangeEvent` converter
- [x] Add `toStakeholderStatusChangeEvent` converter
- [x] Add types to batchTypes.ts (OcfEntityType, OcfEntityDataMap, ENTITY_TAG_MAP)
- [x] Add unit tests for converters

## Implementation Notes

### Retraction Types

Retractions are the opposite of issuances - they undo a security that was issued in error:

- `security_id` - The security being retracted
- `reason_text` - Why the retraction is happening

### EquityCompensationRelease

Used when vested options are released (exercised without immediate sale):

- `security_id` - The equity compensation being released
- `resulting_security_ids` - The stock issued as a result

### EquityCompensationRepricing

Used to reprice underwater options:

- `security_id` - The options being repriced
- `resulting_security_ids` - New options with updated strike price

### Stakeholder Events

Used to track changes to stakeholder status/relationships:

- `stakeholder_id` - The stakeholder being updated
- Changes could include: employee → former employee, board member status, etc.

## Validation

```bash
npm run fix                    # Lint/format
npm run typecheck              # Type check
npm test                       # Unit tests
npm run test:integration       # Integration tests
```

## Dependencies

- Batch API must be complete ([Batch Cap Table Updates](./2026.01.12-batch-cap-table-updates.md))
- Higher priority OCF types should be completed first

## Related

- [ADR-001: Batch Cap Table Updates](../../../../adr/001-batch-cap-table-updates.md)
- [Milestone 2: OCP SDK Implementation](../../../2025/12/2025.12.17-milestone-2-ocp-sdk-implementation.md)

## Changelog

| Date       | Change                                                                                                          | PRs |
| ---------- | --------------------------------------------------------------------------------------------------------------- | --- |
| 2026-01-20 | Created task                                                                                                    | —   |
| 2026-01-21 | Completed: Added stakeholder event types (native + converters), unit tests for all remaining OCF types | —   |

---

_Last updated: 2026-01-21_
