# Task: Support PersonalAirdrop AmuletRules Override

## Status: Complete ✅

**Completed**: 2026-01-14

## Summary

Update the ocp-canton-sdk to support the new `amuletRulesCidOverride` parameter added to
`PersonalAirdrop_ExecuteTransfer` choice in CantonPayments v0.0.31.

## Background

The DAML `PersonalAirdrop_ExecuteTransfer` choice now accepts an optional `amuletRulesCidOverride`
parameter:

- When `None`/`null`: Uses stored `amuletRulesCid` (existing behavior)
- When `Some`/provided: Uses the provided AmuletRules contract ID

This change was made in `open-captable-protocol-daml` to enable updating AmuletRules references
without recreating contracts.

## Implementation Notes

### Phase 1: Backwards Compatible Update

1. ✅ Updated `@fairmint/open-captable-protocol-daml-js` dependency to v0.2.101 (includes CantonPayments v0.0.31)

2. ✅ Searched for SDK functions that exercise `PersonalAirdrop_ExecuteTransfer`:
   - **Result**: No usages found in SDK - the SDK does not currently use this choice
   - No code changes required

3. ✅ Verified SDK compiles and all tests pass with new package version

### Phase 2: Add Override Support (Future)

When SDK functions are added that use `PersonalAirdrop_ExecuteTransfer`:
- Add optional `amuletRulesCidOverride` parameter to function signatures
- Document the new parameter in JSDoc comments

## Testing Results

- [x] `npm run typecheck` - TypeScript compilation passed
- [x] `npm run fix` - Linting/formatting passed
- [x] `npm test` - All 78 tests passed

## Acceptance Criteria

- [x] SDK compiles with new DAML package version
- [x] All existing tests pass
- [x] No runtime behavior changes (backwards compatible)

## Related

- DAML PR: https://github.com/Fairmint/open-captable-protocol-daml/pull/130
- Release Notes: `docs/releases/2026.01.14-cantonpayments-amulet-rules-override.md`
